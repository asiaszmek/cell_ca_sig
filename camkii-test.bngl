begin model
begin parameters
	NA 6.02e23	# molecues/mol
	f  1		# fraction of the cell to simulate
	Vo f*1e-10	# extracellular volume=1/cell_density (L)
	V  f*3e-12	# cytoplasmic volume (L)
	
	#  initial amounts
	CaMCa4_init	20
	CaMKII_init	20

	#  Rate constants
	kf1		30
	kr1		2
	kf2		1
	kf3		0.8
	kf4		10
	kr4		0.08
	kf5		10	
	
end parameters

begin molecule types
	CaMCa4(cmk)
	CaMKII(x~Duu~Cb~Cp~Cpu,x~Duu~Cb~Cp~Cpu,x~Duu~Cb~Cp~Cpu,x~Duu~Cb~Cp~Cpu)	
end molecule types

begin seed species
	CaMCa4(cmk)  CaMCa4_init
	CaMKII(x~Duu,x~Duu,x~Duu,x~Duu)	CaMKII_init
end seed species

begin observables
	01: Molecules CaMKII_autoinhibit	CaMKII(x~Duu,x~Duu,x~Duu,x~Duu)
	02: Molecules CaMKII_bound			CaMKII(x~Cb)
	03: Molecules CaMKII_phosph			CaMKII(x~Cp)
end observables

begin reaction rules
	# CaMCa4 binding
	R1: CaMKII(x~Duu) + CaMCa4(cmk) <-> CaMKII(x~Cb!1).CaMCa4(cmk!1)  kf1,kr1
	#autophosphorylation	
	R2: CaMKII(x~Cb!1,x~Cb!2) -> CaMKII(x~Cp,x~Cp) kf2
	R3: CaMKII(x~Cp,x~Cb!2) -> CaMKII(x~Cp,x~Cp) kf3
	R4: CaMKII(x~Cb!1,x~Cp) -> CaMKII(x~Cp,x~Cp) kf3
	# CaMCa4 unbinding	
	R5: CaMKII(x~Cp) <-> CaMKII(x~Cpu) kf4,kr4
	# dephosphorylation
	R6: CaMKII(x~Cpu) -> CaMKII(x~Duu) kf5
end reaction rules
end model
generate_network({overwrite=>1})
