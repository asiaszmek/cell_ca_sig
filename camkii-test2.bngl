begin model
begin parameters
	#  initial amounts
	CaMCa4_init	2
	CaMKII_init	1

	#  Rate constants
	kf1		1/10000
	kf2		1
	kf4		1
	kf5		1

end parameters

begin molecule types
	CaMCa4(cmk)
	#CaMKII as a pseudo dimer
	CaMKII(T~0~p,C~0~b,L,R) 
end molecule types

begin seed species
	CaMCa4(cmk)  CaMCa4_init
	CaMKII(T~0,C~0,L!1,R!2).CaMKII(T~0,C~0,L!2,R!3).CaMKII(T~0,C~0,L!3,R!4).CaMKII(T~0,C~0,L!4,R!5).CaMKII(T~0,C~0,L!5,R!6).CaMKII(T~0,C~0,L!6,R!1) 	CaMKII_init
end seed species

begin reaction rules
	# CaMCa4 binding
	# R1 works good; seems BioNetGen knows which graph patterns are isomorphic; can test it by set max_iter=1, 2
	R1: CaMKII(T~0,C~0) + CaMCa4(cmk) -> CaMKII(T~0,C~b)  kf1 
	R2: CaMKII(T~0,C~b,L!5,R!6).CaMKII(T~0,C~b,L!6,R!1)-> CaMKII(T~p,C~b,L!5,R!6).CaMKII(T~p,C~b,L!6,R!1) kf2
	R4: CaMKII(T~p) -> CaMKII(T~0)  kf4 
	R5: CaMKII(C~b) -> CaMKII(C~0)  kf5 
end reaction rules
end model
#generate_network({overwrite=>1,max_iter=>5})
generate_network({overwrite=>1})
